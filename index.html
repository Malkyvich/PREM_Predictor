<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rugby Premiership Predictor 25/26</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                        'primary-dark': '#4845b8'
                    }
                }
            }
        }
    </script>
    <style>
        .prediction-card {
            transition: all 0.3s ease;
        }
        .prediction-card:hover {
            transform: translateY(-2px);
        }
        .completed-match {
            opacity: 0.7;
        }
        .winner-highlight {
            background: linear-gradient(45deg, #10b981, #059669);
        }
    </style>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen">
    <div class="container mx-auto px-4 py-6 max-w-6xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold mb-2 bg-gradient-to-r from-primary to-purple-600 bg-clip-text text-transparent">
                üèâ Rugby Premiership Predictor
            </h1>
            <p class="text-lg text-gray-600 dark:text-gray-400">Season 2025/26 ‚Ä¢ 3 Player Championship</p>
        </div>

        <!-- Navigation Tabs -->
        <div class="flex flex-wrap justify-center mb-6 border-b border-gray-200 dark:border-gray-700">
            <button onclick="showTab('leaderboard')" id="tab-leaderboard" class="tab-button px-6 py-3 font-medium border-b-2 border-primary text-primary">
                üèÜ Leaderboard
            </button>
            <button onclick="showTab('predictions')" id="tab-predictions" class="tab-button px-6 py-3 font-medium border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">
                üìä Predictions
            </button>
            <button onclick="showTab('fixtures')" id="tab-fixtures" class="tab-button px-6 py-3 font-medium border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">
                üìÖ Fixtures
            </button>
            <button onclick="showTab('results')" id="tab-results" class="tab-button px-6 py-3 font-medium border-b-2 border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300">
                ‚úÖ Enter Results
            </button>
        </div>

        <!-- Leaderboard Tab -->
        <div id="leaderboard-tab" class="tab-content">
            <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-4">üèÜ Championship Leaderboard</h2>
                <div id="leaderboard-content" class="space-y-3">
                    <!-- Leaderboard will be populated here -->
                </div>
            </div>
            
            <!-- Points System Explanation -->
            <div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4">
                <h3 class="font-bold mb-2">üìã Weekly Ranking System</h3>
                <ul class="text-sm space-y-1">
                    <li><strong>Match Points:</strong> Exact Score (5pts) ‚Ä¢ Correct Result + Margin ‚â§3 (3pts) ‚Ä¢ Correct Result (1pt) ‚Ä¢ Wrong (0pts)</li>
                    <li><strong>Weekly Ranking:</strong> Total match points per Game Week, with accuracy as tiebreaker</li>
                    <li><strong>Season Points:</strong> 1st place = 3pts ‚Ä¢ 2nd place = 2pts ‚Ä¢ 3rd place = 1pt</li>
                    <li><strong>Accuracy Score:</strong> Average margin difference (lower = better) ‚Ä¢ Wrong winners get negative accuracy</li>
                </ul>
            </div>
        </div>

        <!-- Predictions Tab -->
        <div id="predictions-tab" class="tab-content hidden">
            <div class="mb-4 flex flex-wrap gap-3 items-center">
                <div>
                    <label for="player-select" class="block text-sm font-medium mb-2">Select Player:</label>
                    <select id="player-select" class="w-64 p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-base">
                        <option value="player1">Martin</option>
                        <option value="player2">Charles</option>
                        <option value="player3">Alex</option>
                    </select>
                </div>
                <div class="flex gap-2 mt-6">
                    <button onclick="savePredictions()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg font-medium">
                        üíæ Save Predictions
                    </button>
                    <button onclick="downloadData()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg font-medium">
                        üì• Download Data
                    </button>
                    <label class="bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg font-medium cursor-pointer">
                        üì§ Upload Data
                        <input type="file" id="upload-input" accept=".json" class="hidden" onchange="uploadData(event)">
                    </label>
                </div>
            </div>
            
            <div id="save-status" class="mb-4 hidden p-3 rounded-lg">
                <!-- Save status messages will appear here -->
            </div>
            
            <div id="predictions-content" class="grid gap-4">
                <!-- Predictions will be populated here -->
            </div>
        </div>

        <!-- Fixtures Tab -->
        <div id="fixtures-tab" class="tab-content hidden">
            <div class="mb-4 flex flex-wrap gap-3">
                <button onclick="addFixture()" class="bg-primary hover:bg-primary-dark text-white px-4 py-2 rounded-lg font-medium">
                    ‚ûï Add Fixture
                </button>
                <button onclick="resetAllData()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-medium">
                    üóëÔ∏è Reset All Data
                </button>
            </div>
            <div id="fixtures-content" class="space-y-4">
                <!-- Fixtures will be populated here -->
            </div>
        </div>

        <!-- Results Tab -->
        <div id="results-tab" class="tab-content hidden">
            <div class="mb-4">
                <h2 class="text-2xl font-bold mb-2">Enter Match Results</h2>
                <p class="text-gray-600 dark:text-gray-400">Enter actual scores to calculate points and update the leaderboard.</p>
            </div>
            <div id="results-content" class="space-y-4">
                <!-- Results entry will be populated here -->
            </div>
        </div>
    </div>

    <!-- Add Fixture Modal -->
    <div id="fixture-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-md w-full mx-4">
            <h3 class="text-lg font-bold mb-4">Add New Fixture</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-1">Home Team:</label>
                    <select id="home-team" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-base">
                        <!-- Teams will be populated -->
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Away Team:</label>
                    <select id="away-team" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-base">
                        <!-- Teams will be populated -->
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Match Date:</label>
                    <input type="date" id="match-date" class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-base">
                </div>
                <div class="flex justify-end space-x-3">
                    <button onclick="closeFixtureModal()" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">
                        Cancel
                    </button>
                    <button onclick="saveFixture()" class="px-4 py-2 bg-primary text-white hover:bg-primary-dark rounded">
                        Add Fixture
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dark mode setup
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Premiership teams (from Rugby World)
        const teams = [
            'Bath', 'Bristol Bears', 'Exeter', 'Gloucester',
            'Harlequins', 'Leicester Tigers', 'Newcastle Red Bulls', 'Northampton',
            'Sale Sharks', 'Saracens'
        ];

        // Data storage (in memory - will reset on page reload)
        let fixtures = [];
        let predictions = {
            player1: {},
            player2: {},
            player3: {}
        };
        let results = {};
        let playerNames = {
            player1: 'Martin',
            player2: 'Charles', 
            player3: 'Alex'
        };

        // Initialize with REAL 2025-26 Gallagher PREM Rugby fixtures from Rugby World
        function initializeSampleData() {
            fixtures = [
                // ROUND 1 - September 25-28, 2024 (COMPLETED)
                { id: 1, homeTeam: 'Sale Sharks', awayTeam: 'Gloucester', date: '2024-09-25', round: 'Round 1', completed: true },
                { id: 2, homeTeam: 'Harlequins', awayTeam: 'Bath', date: '2024-09-26', round: 'Round 1', completed: true },
                { id: 3, homeTeam: 'Newcastle Red Bulls', awayTeam: 'Saracens', date: '2024-09-26', round: 'Round 1', completed: true },
                { id: 4, homeTeam: 'Northampton', awayTeam: 'Exeter', date: '2024-09-28', round: 'Round 1', completed: true },
                { id: 5, homeTeam: 'Bristol Bears', awayTeam: 'Leicester Tigers', date: '2024-09-28', round: 'Round 1', completed: true },

                // ROUND 2 - October 3-5, 2024 (CURRENT)
                { id: 6, homeTeam: 'Bath', awayTeam: 'Sale Sharks', date: '2024-10-03', round: 'Round 2', completed: false },
                { id: 7, homeTeam: 'Exeter', awayTeam: 'Newcastle Red Bulls', date: '2024-10-04', round: 'Round 2', completed: false },
                { id: 8, homeTeam: 'Leicester Tigers', awayTeam: 'Harlequins', date: '2024-10-04', round: 'Round 2', completed: false },
                { id: 9, homeTeam: 'Saracens', awayTeam: 'Bristol Bears', date: '2024-10-04', round: 'Round 2', completed: false },
                { id: 10, homeTeam: 'Gloucester', awayTeam: 'Northampton', date: '2024-10-05', round: 'Round 2', completed: false },

                // ROUND 3 - October 10-12, 2024
                { id: 11, homeTeam: 'Sale Sharks', awayTeam: 'Newcastle Falcons', date: '2024-10-10', round: 'Round 3', completed: false },
                { id: 12, homeTeam: 'Bristol Bears', awayTeam: 'Exeter', date: '2024-10-11', round: 'Round 3', completed: false },
                { id: 13, homeTeam: 'Northampton', awayTeam: 'Leicester Tigers', date: '2024-10-11', round: 'Round 3', completed: false },
                { id: 14, homeTeam: 'Bath', awayTeam: 'Gloucester', date: '2024-10-11', round: 'Round 3', completed: false },
                { id: 15, homeTeam: 'Harlequins', awayTeam: 'Saracens', date: '2024-10-12', round: 'Round 3', completed: false },

                // ROUND 4 - October 17-19, 2024
                { id: 16, homeTeam: 'Gloucester', awayTeam: 'Bristol Bears', date: '2024-10-17', round: 'Round 4', completed: false },
                { id: 17, homeTeam: 'Newcastle Falcons', awayTeam: 'Northampton', date: '2024-10-17', round: 'Round 4', completed: false },
                { id: 18, homeTeam: 'Leicester Tigers', awayTeam: 'Bath', date: '2024-10-18', round: 'Round 4', completed: false },
                { id: 19, homeTeam: 'Saracens', awayTeam: 'Sale Sharks', date: '2024-10-18', round: 'Round 4', completed: false },
                { id: 20, homeTeam: 'Exeter', awayTeam: 'Harlequins', date: '2024-10-19', round: 'Round 4', completed: false },

                // ROUND 5 - October 24-25, 2024
                { id: 21, homeTeam: 'Northampton', awayTeam: 'Saracens', date: '2024-10-24', round: 'Round 5', completed: false },
                { id: 22, homeTeam: 'Exeter', awayTeam: 'Gloucester', date: '2024-10-25', round: 'Round 5', completed: false },
                { id: 23, homeTeam: 'Harlequins', awayTeam: 'Newcastle Falcons', date: '2024-10-25', round: 'Round 5', completed: false },
                { id: 24, homeTeam: 'Bath', awayTeam: 'Bristol Bears', date: '2024-10-25', round: 'Round 5', completed: false },
                { id: 25, homeTeam: 'Leicester Tigers', awayTeam: 'Sale Sharks', date: '2024-10-25', round: 'Round 5', completed: false },

                // ROUND 6 - November 28-30, 2024
                { id: 26, homeTeam: 'Sale Sharks', awayTeam: 'Exeter', date: '2024-11-28', round: 'Round 6', completed: false },
                { id: 27, homeTeam: 'Newcastle Falcons', awayTeam: 'Leicester Tigers', date: '2024-11-28', round: 'Round 6', completed: false },
                { id: 28, homeTeam: 'Gloucester', awayTeam: 'Harlequins', date: '2024-11-29', round: 'Round 6', completed: false },
                { id: 29, homeTeam: 'Bristol Bears', awayTeam: 'Northampton', date: '2024-11-29', round: 'Round 6', completed: false },
                { id: 30, homeTeam: 'Saracens', awayTeam: 'Bath', date: '2024-11-30', round: 'Round 6', completed: false },

                // ROUND 7 - December 19-21, 2024
                { id: 31, homeTeam: 'Leicester Tigers', awayTeam: 'Gloucester', date: '2024-12-19', round: 'Round 7', completed: false },
                { id: 32, homeTeam: 'Saracens', awayTeam: 'Exeter', date: '2024-12-20', round: 'Round 7', completed: false },
                { id: 33, homeTeam: 'Northampton', awayTeam: 'Sale Sharks', date: '2024-12-20', round: 'Round 7', completed: false },
                { id: 34, homeTeam: 'Harlequins', awayTeam: 'Bristol Bears', date: '2024-12-20', round: 'Round 7', completed: false },
                { id: 35, homeTeam: 'Newcastle Falcons', awayTeam: 'Bath', date: '2024-12-21', round: 'Round 7', completed: false },

                // ROUND 8 - December 26-28, 2024 (Boxing Day Weekend)
                { id: 36, homeTeam: 'Sale Sharks', awayTeam: 'Harlequins', date: '2024-12-26', round: 'Round 8', completed: false },
                { id: 37, homeTeam: 'Bristol Bears', awayTeam: 'Newcastle Falcons', date: '2024-12-27', round: 'Round 8', completed: false },
                { id: 38, homeTeam: 'Gloucester', awayTeam: 'Saracens', date: '2024-12-27', round: 'Round 8', completed: false },
                { id: 39, homeTeam: 'Bath', awayTeam: 'Northampton', date: '2024-12-27', round: 'Round 8', completed: false },
                { id: 40, homeTeam: 'Exeter', awayTeam: 'Leicester Tigers', date: '2024-12-28', round: 'Round 8', completed: false },

                // ROUND 9 - January 2-4, 2025 (New Year)
                { id: 41, homeTeam: 'Newcastle Falcons', awayTeam: 'Gloucester', date: '2025-01-02', round: 'Round 9', completed: false },
                { id: 42, homeTeam: 'Bristol Bears', awayTeam: 'Sale Sharks', date: '2025-01-02', round: 'Round 9', completed: false },
                { id: 43, homeTeam: 'Bath', awayTeam: 'Exeter', date: '2025-01-03', round: 'Round 9', completed: false },
                { id: 44, homeTeam: 'Northampton', awayTeam: 'Harlequins', date: '2025-01-03', round: 'Round 9', completed: false },
                { id: 45, homeTeam: 'Leicester Tigers', awayTeam: 'Saracens', date: '2025-01-04', round: 'Round 9', completed: false },

                // ROUND 10 - January 23-25, 2025
                { id: 46, homeTeam: 'Harlequins', awayTeam: 'Leicester Tigers', date: '2025-01-23', round: 'Round 10', completed: false },
                { id: 47, homeTeam: 'Gloucester', awayTeam: 'Bath', date: '2025-01-23', round: 'Round 10', completed: false },
                { id: 48, homeTeam: 'Exeter', awayTeam: 'Bristol Bears', date: '2025-01-23', round: 'Round 10', completed: false },
                { id: 49, homeTeam: 'Saracens', awayTeam: 'Newcastle Falcons', date: '2025-01-23', round: 'Round 10', completed: false },
                { id: 50, homeTeam: 'Sale Sharks', awayTeam: 'Northampton', date: '2025-01-23', round: 'Round 10', completed: false },

                // ROUND 11 - March 20-22, 2025
                { id: 51, homeTeam: 'Leicester Tigers', awayTeam: 'Bristol Bears', date: '2025-03-20', round: 'Round 11', completed: false },
                { id: 52, homeTeam: 'Harlequins', awayTeam: 'Gloucester', date: '2025-03-20', round: 'Round 11', completed: false },
                { id: 53, homeTeam: 'Exeter', awayTeam: 'Sale Sharks', date: '2025-03-20', round: 'Round 11', completed: false },
                { id: 54, homeTeam: 'Bath', awayTeam: 'Saracens', date: '2025-03-20', round: 'Round 11', completed: false },
                { id: 55, homeTeam: 'Northampton', awayTeam: 'Newcastle Falcons', date: '2025-03-20', round: 'Round 11', completed: false },

                // ROUND 12 - March 27-29, 2025 (Big Game 12)
                { id: 56, homeTeam: 'Saracens', awayTeam: 'Northampton', date: '2025-03-27', round: 'Round 12', completed: false },
                { id: 57, homeTeam: 'Sale Sharks', awayTeam: 'Bath', date: '2025-03-27', round: 'Round 12', completed: false },
                { id: 58, homeTeam: 'Newcastle Falcons', awayTeam: 'Exeter', date: '2025-03-27', round: 'Round 12', completed: false },
                { id: 59, homeTeam: 'Bristol Bears', awayTeam: 'Harlequins', date: '2025-03-27', round: 'Round 12', completed: false },
                { id: 60, homeTeam: 'Gloucester', awayTeam: 'Leicester Tigers', date: '2025-03-28', round: 'Round 12', completed: false },

                // ROUND 13 - April 17-19, 2025
                { id: 61, homeTeam: 'Bath', awayTeam: 'Harlequins', date: '2025-04-17', round: 'Round 13', completed: false },
                { id: 62, homeTeam: 'Leicester Tigers', awayTeam: 'Newcastle Falcons', date: '2025-04-17', round: 'Round 13', completed: false },
                { id: 63, homeTeam: 'Sale Sharks', awayTeam: 'Saracens', date: '2025-04-17', round: 'Round 13', completed: false },
                { id: 64, homeTeam: 'Exeter', awayTeam: 'Northampton', date: '2025-04-17', round: 'Round 13', completed: false },
                { id: 65, homeTeam: 'Bristol Bears', awayTeam: 'Gloucester', date: '2025-04-17', round: 'Round 13', completed: false },

                // ROUND 14 - April 24-26, 2025
                { id: 66, homeTeam: 'Harlequins', awayTeam: 'Sale Sharks', date: '2025-04-24', round: 'Round 14', completed: false },
                { id: 67, homeTeam: 'Gloucester', awayTeam: 'Exeter', date: '2025-04-24', round: 'Round 14', completed: false },
                { id: 68, homeTeam: 'Saracens', awayTeam: 'Leicester Tigers', date: '2025-04-24', round: 'Round 14', completed: false },
                { id: 69, homeTeam: 'Northampton', awayTeam: 'Bath', date: '2025-04-24', round: 'Round 14', completed: false },
                { id: 70, homeTeam: 'Newcastle Falcons', awayTeam: 'Bristol Bears', date: '2025-04-24', round: 'Round 14', completed: false },

                // ROUND 15 - May 8-10, 2025
                { id: 71, homeTeam: 'Leicester Tigers', awayTeam: 'Northampton', date: '2025-05-08', round: 'Round 15', completed: false },
                { id: 72, homeTeam: 'Gloucester', awayTeam: 'Sale Sharks', date: '2025-05-08', round: 'Round 15', completed: false },
                { id: 73, homeTeam: 'Exeter', awayTeam: 'Bath', date: '2025-05-08', round: 'Round 15', completed: false },
                { id: 74, homeTeam: 'Bristol Bears', awayTeam: 'Saracens', date: '2025-05-08', round: 'Round 15', completed: false },
                { id: 75, homeTeam: 'Newcastle Falcons', awayTeam: 'Harlequins', date: '2025-05-08', round: 'Round 15', completed: false },

                // ROUND 16 - May 15-17, 2025
                { id: 76, homeTeam: 'Saracens', awayTeam: 'Gloucester', date: '2025-05-15', round: 'Round 16', completed: false },
                { id: 77, homeTeam: 'Sale Sharks', awayTeam: 'Leicester Tigers', date: '2025-05-15', round: 'Round 16', completed: false },
                { id: 78, homeTeam: 'Northampton', awayTeam: 'Bristol Bears', date: '2025-05-15', round: 'Round 16', completed: false },
                { id: 79, homeTeam: 'Harlequins', awayTeam: 'Exeter', date: '2025-05-15', round: 'Round 16', completed: false },
                { id: 80, homeTeam: 'Bath', awayTeam: 'Newcastle Falcons', date: '2025-05-15', round: 'Round 16', completed: false },

                // ROUND 17 - May 29-31, 2025
                { id: 81, homeTeam: 'Saracens', awayTeam: 'Harlequins', date: '2025-05-29', round: 'Round 17', completed: false },
                { id: 82, homeTeam: 'Northampton', awayTeam: 'Gloucester', date: '2025-05-29', round: 'Round 17', completed: false },
                { id: 83, homeTeam: 'Newcastle Falcons', awayTeam: 'Sale Sharks', date: '2025-05-29', round: 'Round 17', completed: false },
                { id: 84, homeTeam: 'Leicester Tigers', awayTeam: 'Exeter', date: '2025-05-29', round: 'Round 17', completed: false },
                { id: 85, homeTeam: 'Bristol Bears', awayTeam: 'Bath', date: '2025-05-29', round: 'Round 17', completed: false },

                // ROUND 18 - June 5-7, 2025 (Final Round)
                { id: 86, homeTeam: 'Bath', awayTeam: 'Leicester Tigers', date: '2025-06-05', round: 'Round 18', completed: false },
                { id: 87, homeTeam: 'Sale Sharks', awayTeam: 'Bristol Bears', date: '2025-06-05', round: 'Round 18', completed: false },
                { id: 88, homeTeam: 'Harlequins', awayTeam: 'Northampton', date: '2025-06-05', round: 'Round 18', completed: false },
                { id: 89, homeTeam: 'Gloucester', awayTeam: 'Newcastle Falcons', date: '2025-06-05', round: 'Round 18', completed: false },
                { id: 90, homeTeam: 'Exeter', awayTeam: 'Saracens', date: '2025-06-05', round: 'Round 18', completed: false }
            ];

            // Add the actual results from Round 1
            results[1] = { homeScore: 27, awayScore: 10 }; // Sale Sharks 27-10 Gloucester
            results[2] = { homeScore: 31, awayScore: 47 }; // Harlequins 31-47 Bath
            results[3] = { homeScore: 17, awayScore: 39 }; // Newcastle Red Bulls 17-39 Saracens
            results[4] = { homeScore: 33, awayScore: 33 }; // Northampton 33-33 Exeter
            results[5] = { homeScore: 42, awayScore: 24 }; // Bristol Bears 42-24 Leicester Tigers

            // Add Round 1 predictions
            // Charles's predictions
            predictions.player2[1] = { homeScore: 32, awayScore: 25 }; // Sale Sharks vs Gloucester
            predictions.player2[2] = { homeScore: 10, awayScore: 25 }; // Harlequins vs Bath
            predictions.player2[3] = { homeScore: 15, awayScore: 33 }; // Newcastle Red Bulls vs Saracens
            predictions.player2[4] = { homeScore: 32, awayScore: 16 }; // Northampton vs Exeter
            predictions.player2[5] = { homeScore: 32, awayScore: 25 }; // Bristol Bears vs Leicester Tigers

            // Martin's predictions
            predictions.player1[1] = { homeScore: 29, awayScore: 12 }; // Sale Sharks vs Gloucester
            predictions.player1[2] = { homeScore: 20, awayScore: 26 }; // Harlequins vs Bath
            predictions.player1[3] = { homeScore: 11, awayScore: 27 }; // Newcastle Red Bulls vs Saracens
            predictions.player1[4] = { homeScore: 33, awayScore: 22 }; // Northampton vs Exeter
            predictions.player1[5] = { homeScore: 26, awayScore: 22 }; // Bristol Bears vs Leicester Tigers

            // Alex's predictions (only first 3 matches)
            predictions.player3[1] = { homeScore: 30, awayScore: 26 }; // Sale Sharks vs Gloucester
            predictions.player3[2] = { homeScore: 26, awayScore: 30 }; // Harlequins vs Bath
            predictions.player3[3] = { homeScore: 26, awayScore: 30 }; // Newcastle Red Bulls vs Saracens
        }

        // Tab navigation
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('border-primary', 'text-primary');
                btn.classList.add('border-transparent', 'text-gray-500', 'dark:text-gray-400');
            });

            // Show selected tab
            document.getElementById(`${tabName}-tab`).classList.remove('hidden');
            document.getElementById(`tab-${tabName}`).classList.add('border-primary', 'text-primary');
            document.getElementById(`tab-${tabName}`).classList.remove('border-transparent', 'text-gray-500', 'dark:text-gray-400');

            // Refresh content
            if (tabName === 'leaderboard') updateLeaderboard();
            if (tabName === 'predictions') updatePredictionsView();
            if (tabName === 'fixtures') updateFixturesView();
            if (tabName === 'results') updateResultsView();
        }

        // Calculate points for a prediction (unchanged)
        function calculatePoints(prediction, actual) {
            if (!prediction || !actual) return 0;

            const predHome = parseInt(prediction.homeScore);
            const predAway = parseInt(prediction.awayScore);
            const actualHome = parseInt(actual.homeScore);
            const actualAway = parseInt(actual.awayScore);

            // Exact score
            if (predHome === actualHome && predAway === actualAway) {
                return 5;
            }

            // Check if result is correct
            const predResult = predHome > predAway ? 'home' : (predHome < predAway ? 'away' : 'draw');
            const actualResult = actualHome > actualAway ? 'home' : (actualHome < actualAway ? 'away' : 'draw');

            if (predResult === actualResult) {
                // Correct result - check if margin of victory is within 3 points
                const predMargin = Math.abs(predHome - predAway);
                const actualMargin = Math.abs(actualHome - actualAway);
                const marginDiff = Math.abs(predMargin - actualMargin);
                
                if (marginDiff <= 3) {
                    return 3; // Correct result with margin within 3 points
                }
                return 1; // Correct result only
            }

            return 0; // Wrong result
        }

        // Calculate accuracy score for a prediction
        function calculateAccuracy(prediction, actual) {
            if (!prediction || !actual) return null;

            const predHome = parseInt(prediction.homeScore);
            const predAway = parseInt(prediction.awayScore);
            const actualHome = parseInt(actual.homeScore);
            const actualAway = parseInt(actual.awayScore);

            const predResult = predHome > predAway ? 'home' : (predHome < predAway ? 'away' : 'draw');
            const actualResult = actualHome > actualAway ? 'home' : (actualHome < actualAway ? 'away' : 'draw');

            // If wrong winner prediction, return negative accuracy
            if (predResult !== actualResult) {
                return -Math.abs(Math.abs(predHome - predAway) - Math.abs(actualHome - actualAway));
            }

            // If correct winner, return margin difference (lower is better)
            const predMargin = Math.abs(predHome - predAway);
            const actualMargin = Math.abs(actualHome - actualAway);
            return Math.abs(predMargin - actualMargin);
        }

        // Calculate weekly rankings and season points
        function calculateWeeklyRankings() {
            const weeklyResults = {};
            const seasonTotals = {};

            // Initialize season totals
            Object.keys(playerNames).forEach(playerId => {
                seasonTotals[playerId] = {
                    name: playerNames[playerId],
                    seasonPoints: 0,
                    weeksWon: 0,
                    weeksSecond: 0,
                    weeksThird: 0,
                    weeklyHistory: []
                };
            });

            // Group fixtures by round
            const fixturesByRound = {};
            fixtures.forEach(fixture => {
                if (fixture.completed && results[fixture.id]) {
                    const round = fixture.round || 'Other';
                    if (!fixturesByRound[round]) fixturesByRound[round] = [];
                    fixturesByRound[round].push(fixture);
                }
            });

            // Calculate for each completed round
            Object.keys(fixturesByRound).forEach(round => {
                const roundFixtures = fixturesByRound[round];
                const weeklyStats = {};

                // Initialize weekly stats
                Object.keys(playerNames).forEach(playerId => {
                    weeklyStats[playerId] = {
                        name: playerNames[playerId],
                        weeklyPoints: 0,
                        predictions: 0,
                        accuracyScores: []
                    };
                });

                // Calculate weekly points and accuracy for each player
                roundFixtures.forEach(fixture => {
                    Object.keys(predictions).forEach(playerId => {
                        const prediction = predictions[playerId][fixture.id];
                        if (prediction) {
                            weeklyStats[playerId].predictions++;
                            weeklyStats[playerId].weeklyPoints += calculatePoints(prediction, results[fixture.id]);
                            
                            const accuracy = calculateAccuracy(prediction, results[fixture.id]);
                            if (accuracy !== null) {
                                weeklyStats[playerId].accuracyScores.push(accuracy);
                            }
                        }
                    });
                });

                // Calculate average accuracy for each player
                Object.keys(weeklyStats).forEach(playerId => {
                    const stats = weeklyStats[playerId];
                    if (stats.accuracyScores.length > 0) {
                        stats.averageAccuracy = stats.accuracyScores.reduce((sum, acc) => sum + acc, 0) / stats.accuracyScores.length;
                    } else {
                        stats.averageAccuracy = 999; // High penalty for no predictions
                    }
                });

                // Rank players for this week (by points, then by accuracy)
                const weeklyRanking = Object.values(weeklyStats)
                    .filter(stats => stats.predictions > 0)
                    .sort((a, b) => {
                        if (b.weeklyPoints === a.weeklyPoints) {
                            return a.averageAccuracy - b.averageAccuracy; // Lower accuracy is better
                        }
                        return b.weeklyPoints - a.weeklyPoints;
                    });

                // Award season points based on weekly ranking
                weeklyRanking.forEach((player, index) => {
                    const playerId = Object.keys(playerNames).find(id => playerNames[id] === player.name);
                    const position = index + 1;
                    
                    let seasonPoints = 0;
                    if (position === 1) {
                        seasonPoints = 3;
                        seasonTotals[playerId].weeksWon++;
                    } else if (position === 2) {
                        seasonPoints = 2;
                        seasonTotals[playerId].weeksSecond++;
                    } else if (position === 3) {
                        seasonPoints = 1;
                        seasonTotals[playerId].weeksThird++;
                    }

                    seasonTotals[playerId].seasonPoints += seasonPoints;
                    seasonTotals[playerId].weeklyHistory.push({
                        round,
                        position,
                        weeklyPoints: player.weeklyPoints,
                        accuracy: player.averageAccuracy.toFixed(2),
                        seasonPoints
                    });
                });

                weeklyResults[round] = weeklyRanking;
            });

            return { weeklyResults, seasonTotals };
        }

        // Update leaderboard
        function updateLeaderboard() {
            const { weeklyResults, seasonTotals } = calculateWeeklyRankings();

            // Sort players by season points
            const sortedPlayers = Object.values(seasonTotals).sort((a, b) => b.seasonPoints - a.seasonPoints);

            // Render season leaderboard
            const seasonLeaderboardHtml = sortedPlayers.map((player, index) => {
                const position = index + 1;
                const isWinner = position === 1 && player.seasonPoints > 0;
                
                return `
                    <div class="flex items-center justify-between p-4 rounded-lg border ${isWinner ? 'winner-highlight text-white' : 'bg-white dark:bg-gray-700 border-gray-200 dark:border-gray-600'}">
                        <div class="flex items-center space-x-4">
                            <div class="text-2xl font-bold ${isWinner ? 'text-yellow-300' : 'text-gray-500'}">
                                ${position === 1 ? 'ü•á' : position === 2 ? 'ü•à' : position === 3 ? 'ü•â' : `#${position}`}
                            </div>
                            <div>
                                <div class="font-bold text-lg">${player.name}</div>
                                <div class="text-sm ${isWinner ? 'text-gray-200' : 'text-gray-500 dark:text-gray-400'}">
                                    ${player.weeksWon}W ‚Ä¢ ${player.weeksSecond}√ó 2nd ‚Ä¢ ${player.weeksThird}√ó 3rd
                                </div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-2xl font-bold">${player.seasonPoints}</div>
                            <div class="text-sm ${isWinner ? 'text-gray-200' : 'text-gray-500 dark:text-gray-400'}">
                                Season Points
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            // Render weekly results
            const weeklyResultsHtml = Object.keys(weeklyResults).reverse().map(round => {
                const weekResults = weeklyResults[round];
                
                const weekHtml = weekResults.map((player, index) => {
                    const position = index + 1;
                    const seasonPointsEarned = position === 1 ? 3 : position === 2 ? 2 : position === 3 ? 1 : 0;
                    
                    return `
                        <div class="flex justify-between items-center py-2 px-3 rounded ${position === 1 ? 'bg-yellow-50 dark:bg-yellow-900/20' : position === 2 ? 'bg-gray-50 dark:bg-gray-700/50' : position === 3 ? 'bg-orange-50 dark:bg-orange-900/20' : 'bg-gray-25 dark:bg-gray-800/30'}">
                            <div class="flex items-center space-x-3">
                                <span class="font-bold text-lg">${position === 1 ? 'ü•á' : position === 2 ? 'ü•à' : position === 3 ? 'ü•â' : `#${position}`}</span>
                                <span class="font-medium">${player.name}</span>
                            </div>
                            <div class="text-right text-sm">
                                <div class="font-bold">${player.weeklyPoints} pts ‚Ä¢ ${seasonPointsEarned} season pts</div>
                                <div class="text-gray-500 dark:text-gray-400">Accuracy: ${player.averageAccuracy.toFixed(1)}</div>
                            </div>
                        </div>
                    `;
                }).join('');

                return `
                    <div class="mb-6">
                        <h4 class="font-bold text-lg mb-3 text-primary">${round} Results</h4>
                        <div class="space-y-2">
                            ${weekHtml}
                        </div>
                    </div>
                `;
            }).join('');

            const leaderboardContent = `
                <div class="mb-8">
                    <h3 class="text-xl font-bold mb-4">üèÜ Season Championship</h3>
                    <div class="space-y-3">
                        ${seasonLeaderboardHtml}
                    </div>
                </div>
                ${weeklyResultsHtml ? `
                    <div>
                        <h3 class="text-xl font-bold mb-4">üìÖ Weekly Results</h3>
                        ${weeklyResultsHtml}
                    </div>
                ` : ''}
            `;

            document.getElementById('leaderboard-content').innerHTML = leaderboardContent || '<p class="text-gray-500 dark:text-gray-400 text-center py-8">No predictions made yet. Make some predictions to see the leaderboard!</p>';
        }

        // Update predictions view
        function updatePredictionsView() {
            const selectedPlayer = document.getElementById('player-select').value;
            const playerPredictions = predictions[selectedPlayer] || {};

            // Group fixtures by round
            const fixturesByRound = {};
            fixtures.forEach(fixture => {
                const round = fixture.round || 'Other';
                if (!fixturesByRound[round]) fixturesByRound[round] = [];
                fixturesByRound[round].push(fixture);
            });

            const predictionsHtml = Object.keys(fixturesByRound).map(round => {
                const roundFixtures = fixturesByRound[round];
                const fixturesHtml = roundFixtures.map(fixture => {
                    const prediction = playerPredictions[fixture.id] || {};
                    const isCompleted = fixture.completed;
                    const actualResult = results[fixture.id];
                    const points = isCompleted && actualResult ? calculatePoints(prediction, actualResult) : null;

                    return `
                        <div class="prediction-card bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700 ${isCompleted ? 'completed-match' : ''}">
                            <div class="flex flex-col sm:flex-row sm:items-center justify-between mb-3">
                                <div class="font-bold text-lg mb-2 sm:mb-0">
                                    ${fixture.homeTeam} vs ${fixture.awayTeam}
                                </div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">
                                    ${new Date(fixture.date).toLocaleDateString()}
                                    ${isCompleted ? ' ‚Ä¢ COMPLETED' : ''}
                                </div>
                            </div>
                            
                            ${isCompleted ? `
                                <div class="mb-3 p-2 bg-gray-100 dark:bg-gray-700 rounded">
                                    <div class="text-sm font-medium mb-1">Your Prediction vs Actual Result:</div>
                                    <div class="flex justify-between">
                                        <span>Predicted: ${prediction.homeScore || '-'} - ${prediction.awayScore || '-'}</span>
                                        <span>Actual: ${actualResult.homeScore} - ${actualResult.awayScore}</span>
                                    </div>
                                    ${points !== null ? `<div class="font-bold text-primary mt-1">Points earned: ${points}</div>` : ''}
                                </div>
                            ` : ''}

                            <div class="flex space-x-4 items-center">
                                <div class="flex-1">
                                    <label class="block text-sm font-medium mb-1">${fixture.homeTeam}</label>
                                    <input type="number" min="0" max="100" 
                                           value="${prediction.homeScore || ''}"
                                           onchange="updatePrediction('${selectedPlayer}', ${fixture.id}, 'homeScore', this.value)"
                                           ${isCompleted ? 'disabled' : ''}
                                           class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-base ${isCompleted ? 'opacity-50' : ''}">
                                </div>
                                <div class="text-xl font-bold">-</div>
                                <div class="flex-1">
                                    <label class="block text-sm font-medium mb-1">${fixture.awayTeam}</label>
                                    <input type="number" min="0" max="100" 
                                           value="${prediction.awayScore || ''}"
                                           onchange="updatePrediction('${selectedPlayer}', ${fixture.id}, 'awayScore', this.value)"
                                           ${isCompleted ? 'disabled' : ''}
                                           class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-base ${isCompleted ? 'opacity-50' : ''}">
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');

                return `
                    <div class="mb-8">
                        <h3 class="text-xl font-bold mb-4 text-primary">${round}</h3>
                        <div class="grid gap-4">
                            ${fixturesHtml}
                        </div>
                    </div>
                `;
            }).join('');

            document.getElementById('predictions-content').innerHTML = predictionsHtml || '<p class="text-gray-500 dark:text-gray-400 text-center py-8">No fixtures available yet.</p>';
        }

        // Update prediction
        function updatePrediction(playerId, fixtureId, scoreType, value) {
            if (!predictions[playerId]) predictions[playerId] = {};
            if (!predictions[playerId][fixtureId]) predictions[playerId][fixtureId] = {};
            
            predictions[playerId][fixtureId][scoreType] = value;
        }

        // Update fixtures view
        function updateFixturesView() {
            const fixturesHtml = fixtures.map(fixture => `
                <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
                    <div class="flex flex-col sm:flex-row sm:items-center justify-between">
                        <div>
                            <div class="font-bold text-lg">${fixture.homeTeam} vs ${fixture.awayTeam}</div>
                            <div class="text-sm text-gray-500 dark:text-gray-400">
                                ${new Date(fixture.date).toLocaleDateString()}
                                ${fixture.completed ? ' ‚Ä¢ COMPLETED' : ''}
                            </div>
                        </div>
                        <button onclick="removeFixture(${fixture.id})" 
                                class="mt-2 sm:mt-0 bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm">
                            Remove
                        </button>
                    </div>
                </div>
            `).join('');

            document.getElementById('fixtures-content').innerHTML = fixturesHtml || '<p class="text-gray-500 dark:text-gray-400 text-center py-8">No fixtures added yet.</p>';
        }

        // Update results view
        function updateResultsView() {
            const resultsHtml = fixtures.filter(f => !f.completed).map(fixture => `
                <div class="bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700">
                    <div class="font-bold text-lg mb-3">${fixture.homeTeam} vs ${fixture.awayTeam}</div>
                    <div class="text-sm text-gray-500 dark:text-gray-400 mb-4">${new Date(fixture.date).toLocaleDateString()}</div>
                    
                    <div class="flex space-x-4 items-end">
                        <div class="flex-1">
                            <label class="block text-sm font-medium mb-1">${fixture.homeTeam} Score</label>
                            <input type="number" min="0" max="100" id="result-home-${fixture.id}" 
                                   class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-base">
                        </div>
                        <div class="text-xl font-bold pb-2">-</div>
                        <div class="flex-1">
                            <label class="block text-sm font-medium mb-1">${fixture.awayTeam} Score</label>
                            <input type="number" min="0" max="100" id="result-away-${fixture.id}" 
                                   class="w-full p-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-base">
                        </div>
                        <button onclick="saveResult(${fixture.id})" 
                                class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded font-medium">
                            Save Result
                        </button>
                    </div>
                </div>
            `).join('');

            document.getElementById('results-content').innerHTML = resultsHtml || '<p class="text-gray-500 dark:text-gray-400 text-center py-8">All fixtures completed!</p>';
        }

        // Add fixture modal functions
        function addFixture() {
            // Populate team dropdowns
            const homeSelect = document.getElementById('home-team');
            const awaySelect = document.getElementById('away-team');
            
            const teamOptions = teams.map(team => `<option value="${team}">${team}</option>`).join('');
            homeSelect.innerHTML = teamOptions;
            awaySelect.innerHTML = teamOptions;
            
            // Set default date to today
            document.getElementById('match-date').valueAsDate = new Date();
            
            document.getElementById('fixture-modal').classList.remove('hidden');
            document.getElementById('fixture-modal').classList.add('flex');
        }

        function closeFixtureModal() {
            document.getElementById('fixture-modal').classList.add('hidden');
            document.getElementById('fixture-modal').classList.remove('flex');
        }

        function saveFixture() {
            const homeTeam = document.getElementById('home-team').value;
            const awayTeam = document.getElementById('away-team').value;
            const matchDate = document.getElementById('match-date').value;

            if (homeTeam === awayTeam) {
                showAlert('Please select different teams for home and away.');
                return;
            }

            const newFixture = {
                id: Date.now(),
                homeTeam,
                awayTeam,
                date: matchDate,
                completed: false
            };

            fixtures.push(newFixture);
            closeFixtureModal();
            updateFixturesView();
        }

        function removeFixture(fixtureId) {
            showConfirmDialog('Are you sure you want to remove this fixture? This will also remove all predictions and results for this match.', () => {
                fixtures = fixtures.filter(f => f.id !== fixtureId);
                
                // Remove predictions and results for this fixture
                Object.keys(predictions).forEach(playerId => {
                    delete predictions[playerId][fixtureId];
                });
                delete results[fixtureId];
                
                updateFixturesView();
            });
        }

        function saveResult(fixtureId) {
            const homeScore = document.getElementById(`result-home-${fixtureId}`).value;
            const awayScore = document.getElementById(`result-away-${fixtureId}`).value;

            if (homeScore === '' || awayScore === '') {
                showAlert('Please enter both scores.');
                return;
            }

            results[fixtureId] = {
                homeScore: parseInt(homeScore),
                awayScore: parseInt(awayScore)
            };

            // Mark fixture as completed
            const fixture = fixtures.find(f => f.id === fixtureId);
            if (fixture) fixture.completed = true;

            showAlert('Result saved successfully!');
            updateResultsView();
            updateLeaderboard();
        }

        function resetAllData() {
            showConfirmDialog('Are you sure you want to reset all data? This will remove all fixtures, predictions, and results.', () => {
                fixtures = [];
                predictions = { player1: {}, player2: {}, player3: {} };
                results = {};
                
                updateFixturesView();
                updatePredictionsView();
                updateResultsView();
                updateLeaderboard();
                
                showAlert('All data has been reset.');
            });
        }

        // Custom modal functions (replacing alert/confirm)
        function showAlert(message) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${message}</p>
                    <div class="flex justify-end">
                        <button class="px-4 py-2 bg-primary text-white hover:bg-primary-dark rounded" onclick="this.closest('.fixed').remove()">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function showConfirmDialog(message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg max-w-sm w-full mx-4">
                    <p class="text-gray-700 dark:text-gray-300 mb-4">${message}</p>
                    <div class="flex justify-end space-x-3">
                        <button class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded" onclick="this.closest('.fixed').remove()">Cancel</button>
                        <button class="px-4 py-2 bg-red-500 text-white hover:bg-red-600 rounded" onclick="this.closest('.fixed').remove(); (${onConfirm})()">Confirm</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // Save predictions function
        function savePredictions() {
            const selectedPlayer = document.getElementById('player-select').value;
            const playerName = playerNames[selectedPlayer];
            
            // Count current predictions for this player
            let predictionCount = 0;
            Object.keys(predictions[selectedPlayer] || {}).forEach(fixtureId => {
                const prediction = predictions[selectedPlayer][fixtureId];
                if (prediction && prediction.homeScore !== undefined && prediction.awayScore !== undefined && 
                    prediction.homeScore !== '' && prediction.awayScore !== '') {
                    predictionCount++;
                }
            });

            showSaveStatus(`‚úÖ Predictions saved for ${playerName}! (${predictionCount} matches predicted)`, 'success');
        }

        // Show save status message
        function showSaveStatus(message, type) {
            const statusDiv = document.getElementById('save-status');
            statusDiv.className = `mb-4 p-3 rounded-lg ${type === 'success' ? 'bg-green-100 dark:bg-green-900/20 text-green-800 dark:text-green-300' : 'bg-red-100 dark:bg-red-900/20 text-red-800 dark:text-red-300'}`;
            statusDiv.textContent = message;
            statusDiv.classList.remove('hidden');
            
            // Hide after 3 seconds
            setTimeout(() => {
                statusDiv.classList.add('hidden');
            }, 3000);
        }

        // Download data as JSON file
        function downloadData() {
            const data = {
                fixtures,
                predictions,
                results,
                playerNames,
                exportDate: new Date().toISOString(),
                version: '1.0'
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `rugby-predictor-data-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSaveStatus('‚úÖ Data downloaded successfully! Keep this file safe.', 'success');
        }

        // Upload data from JSON file
        function uploadData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    // Validate data structure
                    if (!data.fixtures || !data.predictions || !data.results) {
                        throw new Error('Invalid data format');
                    }

                    // Load the data
                    fixtures = data.fixtures || [];
                    predictions = data.predictions || { player1: {}, player2: {}, player3: {} };
                    results = data.results || {};
                    if (data.playerNames) {
                        playerNames = data.playerNames;
                    }

                    // Refresh all views
                    updateLeaderboard();
                    updatePredictionsView();
                    updateFixturesView();
                    updateResultsView();
                    
                    showSaveStatus('‚úÖ Data uploaded successfully! All predictions and results have been restored.', 'success');
                    
                } catch (error) {
                    showSaveStatus('‚ùå Error uploading file: Invalid format or corrupted data.', 'error');
                }
            };
            reader.readAsText(file);
            
            // Reset the input
            event.target.value = '';
        }

        // Player selection change
        document.getElementById('player-select').addEventListener('change', updatePredictionsView);

        // Initialize the app
        initializeSampleData();
        showTab('leaderboard');
    </script>
</body>
</html>
